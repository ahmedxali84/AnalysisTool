<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive Data Analysis Tool</title>
  <style>
    /* Basic styling for the page and table */
    body {
  font-family: 'Courier New', Courier, monospace; /* Monospaced font for hacker feel */
  margin: 0;
  padding: 0;
  background-color: #000000; /* Black background */
  color: #00FF00; /* Green text color */
  overflow-x: hidden; /* Prevent horizontal scroll */
  font-size: 16px; /* Set base font size */
}

h1 {
  text-align: center;
  font-size: 3rem;
  color: #00FF00; /* Green text color */
  text-shadow: 0 0 15px #00FF00, 0 0 30px #00FF00, 0 0 50px #00FF00; /* Glowing green effect */
  margin-top: 20px;
}

.container {
  max-width: 1200px;
  margin: 30px auto;
  padding: 20px;
  background: #111111; /* Dark background for container */
  box-shadow: 0 0 20px rgba(0, 255, 0, 0.8); /* Green glowing effect around container */
  border-radius: 12px;
}

.section {
  margin-bottom: 30px;
}

label, select, button, input {
  display: block;
  margin-bottom: 15px;
  font-size: 1.5rem;
  padding: 12px;
  background-color: #222222; /* Dark background for inputs */
  border: 1px solid #00FF00; /* Green border */
  color: #00FF00; /* Green text color */
  border-radius: 8px;
  width: 100%;
  box-sizing: border-box;
  transition: all 0.3s ease;
}

button {
  background-color: #333333;
  color: #00FF00; /* Green text */
  border: 1px solid #00FF00;
  cursor: pointer;
  transition: background-color 0.3s, transform 0.2s ease;
  font-size: 1.5rem;
  padding: 15px;
}

button:hover {
  background-color: #444444; /* Slightly lighter grey on hover */
  transform: scale(1.05); /* Button enlarges slightly on hover */
}

button:active {
  transform: scale(0.98); /* Button shrinks slightly when clicked */
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 30px;
  color: #00FF00; /* Green text for table */
  font-size: 1.5rem;
}

table, th, td {
  border: 1px solid #00FF00; /* Green table borders */
}

th, td {
  padding: 15px;
  text-align: center;
}

th {
  background-color: #222222; /* Dark grey background for header */
  text-shadow: 0 0 10px #00FF00, 0 0 15px #00FF00; /* Glowing text for header */
}

td {
  background-color: #1a1a1a; /* Slightly lighter grey for cells */
}

.output {
  margin-top: 20px;
  color: #00FF00; /* Green text */
  font-size: 1.4rem;
  text-align: center;
  text-shadow: 0 0 5px #00FF00;
}

input:focus, select:focus, button:focus {
  outline: none;
  border-color: #00FF00;
  box-shadow: 0 0 15px #00FF00; /* Glowing focus effect */
}

input, select {
  background-color: #1a1a1a; /* Darker background for inputs */
  color: #00FF00; /* Green text */
}

.section h2 {
  font-size: 2rem;
  color: #00FF00;
  text-shadow: 0 0 8px #00FF00, 0 0 15px #00FF00;
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}

input[type="file"] {
  background-color: #222222;
  color: #00FF00;
  font-size: 1.4rem;
  padding: 10px;
}

input[type="file"]::file-selector-button {
  background-color: #333333;
  color: #00FF00;
  font-size: 1.4rem;
  border: none;
  cursor: pointer;
}

input[type="file"]:hover::file-selector-button {
  background-color: #444444;
}

input:disabled, select:disabled, button:disabled {
  background-color: #555555;
  color: #444444;
  cursor: not-allowed;
}
.loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 1;
      animation: loaderFadeOut 5s forwards;
    }

    .loader h1 {
      font-size: 3rem;
      color: #00FF00;
      text-shadow: 0 0 15px #00FF00, 0 0 30px #00FF00, 0 0 50px #00FF00; /* Glowing green effect */
      animation: glow 3s infinite alternate; /* Glowing text animation */
    }

    .loader p {
      font-size: 1.5rem;
      color: #00FF00;
      margin-top: 20px;
      text-shadow: 0 0 10px #00FF00, 0 0 20px #00FF00;
      animation: blink 3s infinite alternate; /* Blinking text animation */
    }

    /* Animation for loader fade out */
    @keyframes loaderFadeOut {
      0% {
        opacity: 4;
      }
      100% {
        opacity: 0;
        visibility: hidden;
      }
    }

@media (max-width: 768px) {
  body {
    font-size: 14px;
  }

  h1 {
    font-size: 2.5rem;
  }

  .container {
    width: 95%;
    padding: 15px;
  }

  label, select, input, button {
    font-size: 1.2rem;
  }

  table, th, td {
    font-size: 1.2rem;
  }
}

  </style>

</head>
<body>
    <div class="loader">
        <h1>ANALYSIS TOOL</h1>
        <p>ANALYZE WITH US</p>
      </div>
  <h1>Comprehensive Data Analysis Tool</h1>
  <div class="container">
    <div class="section">
      <h2>Data Management</h2>
      <input type="file" id="fileInput" accept=".csv">
      <button id="exportData">Export Data</button>
    </div>

    <div class="section">
      <h2>Operations</h2>
      <label for="rowLimitInput">Number of rows to display:</label>
      <input type="number" id="rowLimitInput" min="1" placeholder="Enter number of rows">
      <select id="operationSelect">
        <option value="">Select Operation</option>
        <option value="cleaning">Data Cleaning</option>
        <option value="descriptive">Descriptive Statistics</option>
      </select>
      <button id="processBtn">Process</button>
    </div>

    <table id="dataTable"></table>
    <div class="output" id="output"></div>
  </div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const rowLimitInput = document.getElementById('rowLimitInput');
    const operationSelect = document.getElementById('operationSelect');
    const processBtn = document.getElementById('processBtn');
    const dataTable = document.getElementById('dataTable');
    const output = document.getElementById('output');
    const exportData = document.getElementById('exportData');

    let parsedData = []; // Store the parsed CSV data

    fileInput.addEventListener('change', handleFile);
    processBtn.addEventListener('click', processOperation);
    exportData.addEventListener('click', exportToCSV);

    setTimeout(() => {
      loader.style.display = 'none';
      container.style.display = 'block';
    }, 3000);

    function handleFile(event) {
      const file = event.target.files[0];
      if (file && file.type === 'text/csv') {
        const reader = new FileReader();
        reader.onload = function(e) {
          parsedData = parseCSV(e.target.result);
          displayTable(parsedData);
        };
        reader.readAsText(file);
      } else {
        alert('Please upload a valid CSV file.');
      }
    }

    function parseCSV(data) {
      const rows = data.trim().split('\n');
      return rows.map(row => row.split(',').map(cell => (isNaN(cell) ? cell : parseFloat(cell))));
    }

    function displayTable(data) {
      dataTable.innerHTML = '';  // Clear existing table content
      const rowLimit = parseInt(rowLimitInput.value, 10) || data.length;
      const limitedData = data.slice(0, rowLimit);

      // Creating table header
      const headerRow = document.createElement('tr');
      limitedData[0].forEach((cell, index) => {
        const th = document.createElement('th');
        th.textContent = `Column ${index + 1}`;  // Fix the column name to use proper string interpolation
        headerRow.appendChild(th);
      });
      dataTable.appendChild(headerRow);

      // Creating table body
      limitedData.forEach((row, rowIndex) => {
        const tr = document.createElement('tr');
        row.forEach(cell => {
          const cellElement = document.createElement(rowIndex === 0 ? 'th' : 'td');
          cellElement.textContent = cell;
          tr.appendChild(cellElement);
        });
        dataTable.appendChild(tr);
      });
    }

    async function processOperation() {
      const operation = operationSelect.value;
      if (!operation) {
        alert('Please select an operation.');
        return;
      }

      const rowLimit = parseInt(rowLimitInput.value, 10) || parsedData.length;
      let result = [];

      if (operation === 'cleaning') {
        result = await cleanData(parsedData.slice(0, rowLimit));
        output.textContent = 'Data cleaned successfully!';
      } else if (operation === 'descriptive') {
        const stats = getDescriptiveStats(parsedData.slice(0, rowLimit));
        output.innerHTML = formatDescriptiveStats(stats);
      }

      displayTable(result);
    }

    async function cleanData(data) {
      const missingValueColumns = detectMissingValues(data);

      if (missingValueColumns.length > 0) {
        const userChoice = prompt('Missing values found! Do you want to replace missing values with the median of the column? Type "yes" to replace, "no" to remove rows.');

        if (userChoice.toLowerCase() === 'yes') {
          return fillMissingWithMedian(data, missingValueColumns);
        } else {
          return removeRowsWithMissingValues(data);
        }
      }

      return data;
    }

    function detectMissingValues(data) {
      const missingColumns = [];
      data[0].forEach((_, colIndex) => {
        if (data.some(row => row[colIndex] === '' || row[colIndex] === null || isNaN(row[colIndex]))) {
          missingColumns.push(colIndex);
        }
      });
      return missingColumns;
    }

    function fillMissingWithMedian(data, columns) {
      const medianValues = columns.map(colIndex => {
        const columnData = data.map(row => row[colIndex]).filter(val => val !== '' && val !== null && !isNaN(val));
        const sortedColumn = columnData.sort((a, b) => a - b);
        const median = sortedColumn[Math.floor(sortedColumn.length / 2)];
        return median;
      });

      return data.map(row => {
        columns.forEach((colIndex, idx) => {
          if (row[colIndex] === '' || row[colIndex] === null || isNaN(row[colIndex])) {
            row[colIndex] = medianValues[idx];
          }
        });
        return row;
      });
    }

    function removeRowsWithMissingValues(data) {
      return data.filter(row => !row.some(cell => cell === '' || cell === null || isNaN(cell)));
    }

    function getDescriptiveStats(data) {
      const stats = {
        count: [],
        mean: [],
        std: [],
        min: [],
        median: [],
        max: [],
        variance: [],
      };

      const numColumns = data[0].length;

      for (let colIndex = 0; colIndex < numColumns; colIndex++) {
        const columnData = data.map(row => row[colIndex]).filter(val => val !== '' && val !== null && !isNaN(val));
        if (columnData.length === 0) continue;

        stats.count.push(columnData.length);
        stats.mean.push(mean(columnData));
        stats.std.push(standardDeviation(columnData));
        stats.min.push(Math.min(...columnData));
        stats.median.push(median(columnData));
        stats.max.push(Math.max(...columnData));
        stats.variance.push(variance(columnData));
      }

      return stats;
    }

    function mean(data) {
      return data.reduce((sum, val) => sum + val, 0) / data.length;
    }

    function standardDeviation(data) {
      const avg = mean(data);
      return Math.sqrt(data.reduce((sum, val) => sum + Math.pow(val - avg, 2), 0) / data.length);
    }

    function median(data) {
      const sortedData = [...data].sort((a, b) => a - b);
      const mid = Math.floor(sortedData.length / 2);
      return sortedData.length % 2 !== 0 ? sortedData[mid] : (sortedData[mid - 1] + sortedData[mid]) / 2;
    }

    function variance(data) {
      const avg = mean(data);
      return data.reduce((sum, val) => sum + Math.pow(val - avg, 2), 0) / data.length;
    }

    function formatDescriptiveStats(stats) {
      let result = `<h3>Descriptive Statistics</h3>`;
      result += `<table>`;
      result += `<thead><tr><th>Count</th><th>Mean</th><th>Std Dev</th><th>Min</th><th>Median</th><th>Max</th><th>Variance</th></tr></thead><tbody>`;
      
      stats.count.forEach((_, idx) => {
        result += `<tr>`;
        result += `<td>${stats.count[idx]}</td>`;
        result += `<td>${stats.mean[idx]}</td>`;
        result += `<td>${stats.std[idx]}</td>`;
        result += `<td>${stats.min[idx]}</td>`;
        result += `<td>${stats.median[idx]}</td>`;
        result += `<td>${stats.max[idx]}</td>`;
        result += `<td>${stats.variance[idx]}</td>`;
        result += `</tr>`;
      });

      result += `</tbody></table>`;
      return result;
    }

    function exportToCSV() {
      const csvData = parsedData.map(row => row.join(',')).join('\n');
      const blob = new Blob([csvData], { type: 'text/csv' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'data.csv';
      link.click();
    }
  </script>
</body>
</html>
